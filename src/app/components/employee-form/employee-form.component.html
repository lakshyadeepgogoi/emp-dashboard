@if (isOpen()) {
<div class="modal-overlay" (click)="onBackdropClick($event)">
    <div class="modal-content">
        <div class="modal-header">
            <h2>{{ formTitle }}</h2>
            <button class="close-btn" (click)="onClose()" type="button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                </svg>
            </button>
        </div>

        <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()" class="employee-form">
            <div class="form-group" [class.has-error]="hasError('name')">
                <label for="name">
                    <span class="label-text">Full Name</span>
                    <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                    </svg>
                    <input type="text" id="name" formControlName="name" placeholder="Enter employee name" />
                </div>
                @if (hasError('name')) {
                <span class="error-message">{{ getErrorMessage('name') }}</span>
                }
            </div>

            <div class="form-group" [class.has-error]="hasError('email')">
                <label for="email">
                    <span class="label-text">Email Address</span>
                    <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" />
                    </svg>
                    <input type="email" id="email" formControlName="email" placeholder="Enter email address" />
                </div>
                @if (hasError('email')) {
                <span class="error-message">{{ getErrorMessage('email') }}</span>
                }
            </div>

            <div class="form-group" [class.has-error]="hasError('department')">
                <label for="department">
                    <span class="label-text">Department</span>
                    <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z" />
                    </svg>
                    <select id="department" formControlName="department">
                        <option value="" disabled>Select a department</option>
                        @for (dept of departments; track dept) {
                        <option [value]="dept">{{ dept }}</option>
                        }
                    </select>
                </div>
                @if (hasError('department')) {
                <span class="error-message">{{ getErrorMessage('department') }}</span>
                }
            </div>

            <div class="form-group" [class.has-error]="hasError('dateOfJoining')">
                <label for="dateOfJoining">
                    <span class="label-text">Date of Joining</span>
                    <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                    <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z" />
                    </svg>
                    <input type="date" id="dateOfJoining" formControlName="dateOfJoining" [max]="maxDate" />
                </div>
                @if (hasError('dateOfJoining')) {
                <span class="error-message">{{ getErrorMessage('dateOfJoining') }}</span>
                }
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" (click)="onClose()">
                    Cancel
                </button>
                <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
                    @if (isSubmitting) {
                    <span class="spinner"></span>
                    Saving...
                    } @else {
                    {{ isEditMode ? 'Update Employee' : 'Add Employee' }}
                    }
                </button>
            </div>
        </form>
    </div>
</div>
}